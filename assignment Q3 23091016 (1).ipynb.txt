{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "2a97513e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/latex": [
       "$\\displaystyle \\left[\\begin{matrix}9 & 9 & 5 & 1 & 4\\\\4 & 9 & 0 & 0 & 8\\\\2 & 4 & 0 & 1 & 2\\\\4 & 0 & 5 & 2 & 3\\\\8 & 2 & 5 & 9 & 4\\end{matrix}\\right]$"
      ],
      "text/plain": [
       "Matrix([\n",
       "[9, 9, 5, 1, 4],\n",
       "[4, 9, 0, 0, 8],\n",
       "[2, 4, 0, 1, 2],\n",
       "[4, 0, 5, 2, 3],\n",
       "[8, 2, 5, 9, 4]])"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import sympy as sp\n",
    "#Q3\n",
    "# Singular-value decomposition\n",
    "np.random.seed(16)\n",
    "A = np.random.randint(0, 10, size=(5, 5))\n",
    "sp.Matrix(A)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "8ea30e2b",
   "metadata": {},
   "outputs": [],
   "source": [
    "U,s,Vt = np.linalg.svd(A)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "3367cd19",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/latex": [
       "$\\displaystyle \\left[\\begin{matrix}-1.0 & 0 & 1.0 & 0 & 0\\\\0 & -1.0 & 0 & 0 & 0\\\\0 & 0 & 0 & 0 & -1.0\\\\0 & 0 & 0 & -1.0 & 0\\\\-1.0 & 1.0 & 0 & 0 & 0\\end{matrix}\\right]$"
      ],
      "text/plain": [
       "Matrix([\n",
       "[-1.0,    0, 1.0,    0,    0],\n",
       "[   0, -1.0,   0,    0,    0],\n",
       "[   0,    0,   0,    0, -1.0],\n",
       "[   0,    0,   0, -1.0,    0],\n",
       "[-1.0,  1.0,   0,    0,    0]])"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sp.Matrix(np.round(U))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "39e86804",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([22.13569524, 10.48509677,  4.80917542,  3.29345679,  0.31419103])"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "s"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "66223ab3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/latex": [
       "$\\displaystyle \\left[\\begin{matrix}0 & 0 & 0 & 0 & 0\\\\0 & 0 & 0 & 0 & 0\\\\0 & 0 & 0 & 0 & 0\\\\0 & 0 & 0 & 0 & 0\\\\0 & 0 & 0 & 0 & 0\\end{matrix}\\right]$"
      ],
      "text/plain": [
       "Matrix([\n",
       "[0, 0, 0, 0, 0],\n",
       "[0, 0, 0, 0, 0],\n",
       "[0, 0, 0, 0, 0],\n",
       "[0, 0, 0, 0, 0],\n",
       "[0, 0, 0, 0, 0]])"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Sigma = np.zeros((A.shape[0], A.shape[1]))\n",
    "sp.Matrix(Sigma)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "718e84eb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/latex": [
       "$\\displaystyle \\left[\\begin{matrix}22.1356952421281 & 0 & 0 & 0 & 0\\\\0 & 10.4850967686545 & 0 & 0 & 0\\\\0 & 0 & 4.80917542284188 & 0 & 0\\\\0 & 0 & 0 & 3.29345679297593 & 0\\\\0 & 0 & 0 & 0 & 0.314191032199081\\end{matrix}\\right]$"
      ],
      "text/plain": [
       "Matrix([\n",
       "[22.1356952421281,                0,                0,                0,                 0],\n",
       "[               0, 10.4850967686545,                0,                0,                 0],\n",
       "[               0,                0, 4.80917542284188,                0,                 0],\n",
       "[               0,                0,                0, 3.29345679297593,                 0],\n",
       "[               0,                0,                0,                0, 0.314191032199081]])"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Sigma[:A.shape[1], :A.shape[0]] = np.diag(s)\n",
    "sp.Matrix(Sigma)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "c00ad5f0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/latex": [
       "$\\displaystyle \\left[\\begin{matrix}-0.594183636857297 & -0.531211697706178 & -0.317922489845346 & -0.274093783746909 & -0.434232456263917\\\\0.219601722701837 & -0.616631398031717 & 0.392177697749052 & 0.608643790609033 & -0.21746308166941\\\\0.312742167456446 & 0.055198177551273 & 0.535793434842509 & -0.586961771890096 & -0.517249235290848\\\\0.191474084060911 & 0.41224729289385 & -0.418345023428285 & 0.370262794164193 & -0.693745449905972\\\\0.681359597353043 & -0.405690993094845 & -0.532010131850177 & -0.269827121434694 & 0.123783930151057\\end{matrix}\\right]$"
      ],
      "text/plain": [
       "Matrix([\n",
       "[-0.594183636857297, -0.531211697706178, -0.317922489845346, -0.274093783746909, -0.434232456263917],\n",
       "[ 0.219601722701837, -0.616631398031717,  0.392177697749052,  0.608643790609033,  -0.21746308166941],\n",
       "[ 0.312742167456446,  0.055198177551273,  0.535793434842509, -0.586961771890096, -0.517249235290848],\n",
       "[ 0.191474084060911,   0.41224729289385, -0.418345023428285,  0.370262794164193, -0.693745449905972],\n",
       "[ 0.681359597353043, -0.405690993094845, -0.532010131850177, -0.269827121434694,  0.123783930151057]])"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sp.Matrix(Vt)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "fac41b6e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Verification of SVD\n",
    "B=U@Sigma@Vt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "8fbd619c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/latex": [
       "$\\displaystyle \\left[\\begin{matrix}8.99999999999999 & 8.99999999999999 & 4.99999999999999 & 0.999999999999997 & 4.0\\\\4.0 & 9.0 & -6.73282954835635 \\cdot 10^{-15} & -4.37894334525167 \\cdot 10^{-15} & 8.0\\\\2.0 & 4.0 & -2.47002317362796 \\cdot 10^{-15} & 0.999999999999999 & 2.0\\\\4.0 & -2.39700509444767 \\cdot 10^{-15} & 5.0 & 2.0 & 3.0\\\\8.0 & 1.99999999999999 & 5.0 & 9.0 & 4.0\\end{matrix}\\right]$"
      ],
      "text/plain": [
       "Matrix([\n",
       "[8.99999999999999,      8.99999999999999,      4.99999999999999,     0.999999999999997, 4.0],\n",
       "[             4.0,                   9.0, -6.73282954835635e-15, -4.37894334525167e-15, 8.0],\n",
       "[             2.0,                   4.0, -2.47002317362796e-15,     0.999999999999999, 2.0],\n",
       "[             4.0, -2.39700509444767e-15,                   5.0,                   2.0, 3.0],\n",
       "[             8.0,      1.99999999999999,                   5.0,                   9.0, 4.0]])"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sp.Matrix(B)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "79879342",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/latex": [
       "$\\displaystyle \\left[\\begin{matrix}9.0 & 9.0 & 5.0 & 1.0 & 4.0\\\\4.0 & 9.0 & 0 & 0 & 8.0\\\\2.0 & 4.0 & 0 & 1.0 & 2.0\\\\4.0 & 0 & 5.0 & 2.0 & 3.0\\\\8.0 & 2.0 & 5.0 & 9.0 & 4.0\\end{matrix}\\right]$"
      ],
      "text/plain": [
       "Matrix([\n",
       "[9.0, 9.0, 5.0, 1.0, 4.0],\n",
       "[4.0, 9.0,   0,   0, 8.0],\n",
       "[2.0, 4.0,   0, 1.0, 2.0],\n",
       "[4.0,   0, 5.0, 2.0, 3.0],\n",
       "[8.0, 2.0, 5.0, 9.0, 4.0]])"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "C=np.round(B)\n",
    "sp.Matrix(C)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "9889ed29",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/latex": [
       "$\\displaystyle \\left[\\begin{matrix}8.15766246309781 & 7.2931084895845 & 4.36481956201841 & 3.7630867501954 & 5.96166166314954\\\\6.31706302442859 & 5.64757688628433 & 3.37999278448431 & 2.91402791852574 & 4.61654213162115\\\\2.64754726403017 & 2.36695861286497 & 1.41659037030307 & 1.22129961552793 & 1.93484115048214\\\\3.45650402635758 & 3.09018165104844 & 1.84942886012861 & 1.59446711143328 & 2.52603091089807\\\\6.89804350953321 & 6.16698471020039 & 3.69085082721492 & 3.18203115787393 & 5.04112565671235\\end{matrix}\\right]$"
      ],
      "text/plain": [
       "Matrix([\n",
       "[8.15766246309781,  7.2931084895845, 4.36481956201841,  3.7630867501954, 5.96166166314954],\n",
       "[6.31706302442859, 5.64757688628433, 3.37999278448431, 2.91402791852574, 4.61654213162115],\n",
       "[2.64754726403017, 2.36695861286497, 1.41659037030307, 1.22129961552793, 1.93484115048214],\n",
       "[3.45650402635758, 3.09018165104844, 1.84942886012861, 1.59446711143328, 2.52603091089807],\n",
       "[6.89804350953321, 6.16698471020039, 3.69085082721492, 3.18203115787393, 5.04112565671235]])"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#rank 2 approximation\n",
    "k = 1\n",
    "Uk = U[:,:k] \n",
    "Sigmak = Sigma[:k,:k] \n",
    "Vtk = Vt[:k,:] \n",
    "Ak = Uk@Sigmak@Vtk\n",
    "sp.Matrix(Ak)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "37d62ad0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/latex": [
       "$\\displaystyle \\left[\\begin{matrix}8.78904936769584 & 8.63247789154005 & 5.41662845054329 & 0.665532241390594 & 4.64434482546095\\\\4.16167135321986 & 9.468851678043 & -0.41492649222452 & 0.415004993241917 & 7.24704432121158\\\\1.99806004503414 & 3.46716065933087 & 0.27430994938437 & 0.548117637576258 & 2.7388946175203\\\\4.58069515018899 & 1.05752213182666 & 3.8297147777532 & 2.95955119841731 & 1.16283951433494\\\\7.81118369675799 & 1.67987205998663 & 5.36840149718013 & 8.70811284620314 & 4.56451007722928\\end{matrix}\\right]$"
      ],
      "text/plain": [
       "Matrix([\n",
       "[8.78904936769584, 8.63247789154005,  5.41662845054329, 0.665532241390594, 4.64434482546095],\n",
       "[4.16167135321986,   9.468851678043, -0.41492649222452, 0.415004993241917, 7.24704432121158],\n",
       "[1.99806004503414, 3.46716065933087,  0.27430994938437, 0.548117637576258,  2.7388946175203],\n",
       "[4.58069515018899, 1.05752213182666,   3.8297147777532,  2.95955119841731, 1.16283951433494],\n",
       "[7.81118369675799, 1.67987205998663,  5.36840149718013,  8.70811284620314, 4.56451007722928]])"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#rank 3 approximation\n",
    "k = 3\n",
    "Uk = U[:,:k] \n",
    "Sigmak = Sigma[:k,:k] \n",
    "Vtk = Vt[:k,:] \n",
    "Ak = Uk@Sigmak@Vtk\n",
    "sp.Matrix(Ak)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3c03e498",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5f14d737",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
